enum ModuleKey {
  MODULE_1
  MODULE_2
}

enum SubModuleKey {
  FERRAILLAGE
}

model Module {
  id        String    @id @default(cuid())
  key       ModuleKey @unique
  name      String
  slug      String    @unique
  route     String
  sortOrder Int       @default(100)
  isActive  Boolean   @default(true)

  subscriptions SubscriptionModule[]
  subModules     SubModule[]

  @@index([sortOrder])
}

model SubscriptionModule {
  subscriptionId String
  moduleId       String
  enabledAt      DateTime @default(now())

  subscription Subscription @relation(fields: [subscriptionId], references: [id])
  module       Module       @relation(fields: [moduleId], references: [id])

  @@id([subscriptionId, moduleId])
}

model SubModule {
  id        String       @id @default(cuid())
  key       SubModuleKey @unique
  name      String
  slug      String       @unique
  route     String
  sortOrder Int          @default(100)
  isActive  Boolean      @default(true)

  moduleId  String
  module    Module       @relation(fields: [moduleId], references: [id])

  subscriptions SubscriptionSubModule[]

  @@index([moduleId, sortOrder])
}

model SubscriptionSubModule {
  subscriptionId String
  subModuleId    String
  enabledAt      DateTime @default(now())

  subscription Subscription @relation(fields: [subscriptionId], references: [id])
  subModule     SubModule   @relation(fields: [subModuleId], references: [id])

  @@id([subscriptionId, subModuleId])
}
